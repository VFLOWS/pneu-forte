<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório de Inspeção de Frota</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="pneu-forte-colors.css">
    <script src="tailwind.config.js"></script>
    <style>
        @media print {
            .no-print {
                display: none !important;
            }

            .page-break {
                page-break-before: always;
            }

            body {
                background: white;
                -webkit-print-color-adjust: exact;
            }

            #report-container {
                box-shadow: none;
                margin: 0;
                width: 100%;
            }

            .report-page {
                margin: 0;
                page-break-after: always;
                height: auto;
                min-height: 297mm;
            }
        }

        .report-page {
            width: 210mm;
            min-height: 297mm;
            background: white;
            padding: 20mm;
            margin: 0 auto;
            position: relative;
            display: flex;
            flex-direction: column;
            margin-bottom: 2rem;
        }

        .tire-box {
            width: 80px;
            padding: 4px;
            text-align: center;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            background-color: #f9fafb;
        }

        .tire-value {
            font-weight: bold;
            font-size: 0.9rem;
        }

        .tire-psi {
            font-size: 0.75rem;
            color: #6b7280;
        }

        .axle-line {
            height: 4px;
            background-color: #d1d5db;
            width: 100%;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            z-index: 0;
        }

        /* Extra breathing room for the smallest PSI boxes */
        .report-page div[class*="text-[10px]"][class*="border-2"][class*="border-black"] {
            padding-top: 0.35rem !important;
            padding-bottom: 0.35rem !important;
            padding-left: 0.35rem !important;
            padding-right: 0.35rem !important;
            line-height: 1.1;
        }

        /* Standard padding for all PSI boxes (helps red ones too) */
        .report-page div[class*="border-2"][class*="border-black"][class*="rounded"][class*="shadow-sm"][class*="text-center"] {
            padding-left: 0.35rem;
            padding-right: 0.35rem;
        }

        /* mm callouts are repositioned via JS to avoid overlap */
    </style>
</head>

<body class="bg-gray-200 font-sans">

    <!-- Controls -->
    <div class="fixed top-4 left-4 z-50 no-print">
        <a href="frota-analise-detalhe.html"
            class="px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 flex items-center shadow-md transition-colors">
            <i class="fa-solid fa-arrow-left mr-2"></i>
            Voltar
        </a>
    </div>

    <div class="fixed top-4 right-4 z-50 no-print">
        <button onclick="window.print()"
            class="px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center font-medium shadow-md transition-colors">
            <i class="fa-solid fa-print mr-2"></i>
            Imprimir / Salvar PDF
        </button>
    </div>

    <div id="report-container" class="mx-auto my-8">

        <!-- Page 1: Cover / Intro -->
        <div class="report-page shadow-lg flex flex-col">
            <header class="flex justify-between items-start mb-16">
                <div>
                    <h2 class="text-lg font-bold">Cliente teste</h2>
                    <p class="text-sm">Sr. X</p>
                </div>
                <div class="text-right">
                    <img src="pneu-forte-logo.jpeg" alt="Pneu Forte Logo" class="vipal-logo ml-auto">
                    <p class="text-sm mt-2">27/01/2026</p>
                </div>
            </header>

            <main class="flex-grow flex flex-col justify-center items-center">
                <h1 class="text-2xl font-bold mb-12">RELATÓRIO DE AFERIÇÃO</h1>
                <div class="text-sm text-gray-700 max-w-3xl space-y-4 text-justify">
                    <p><strong>Caro Cliente,</strong></p>
                    <p>O Programa de Orientação ao Transportador (Protrans) é um conjunto de serviços exclusivos da
                        Vipal para aprimorar o desempenho da sua frota. Por meio de visitas, palestras, treinamentos e
                        implantação de softwares de gerenciamento, nossos consultores ajudam você e sua equipe a rodar
                        com muito mais economia e segurança.</p>
                    <p>O relatório que você verá a seguir apresenta os dados avaliados na <strong>AFERIÇÃO DE
                            PNEUS</strong>, seguidos de orientação técnica recomendada por nossa equipe. Tudo isto para
                        você obter ótimos resultados de seus pneus.</p>
                    <p>Para que este trabalho tenha sucesso, é fundamental o envolvimento e comprometimento da sua
                        empresa em todas as suas etapas. Nossa equipe de consultores de negócios e o seu Reformador
                        Autorizado Vipal encontram-se a disposição para a plena realização deste projeto e elaboração de
                        Plano de Ação das melhorias.</p>
                </div>
            </main>

            <footer class="pt-16 mt-auto">
                <div class="flex items-end justify-end">
                    <div class="text-right text-xs text-gray-500 mb-4">1/7</div>
                </div>
            </footer>
        </div>

        <!-- Page 2: Detailed Analysis and Charts -->
        <div class="report-page shadow-lg">
            <header class="flex justify-between items-center mb-6 border-b pb-4">
                <div class="flex items-center gap-4">
                    <div class="bg-gray-100 p-3 rounded-lg border border-gray-200">
                        <i class="fa-solid fa-truck text-2xl text-gray-600"></i>
                    </div>
                    <div>
                        <div class="flex items-center gap-2 flex-wrap">
                            <h1 class="text-xl font-bold text-gray-800">Veículo: 78191</h1>
                            <div class="flex items-center gap-2 text-sm text-gray-600 mt-1 flex-wrap">
                                <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded font-medium text-xs">Truck 6x2</span>
                            </div>
                        </div>
                        <div class="flex items-center gap-2 mt-2 flex-wrap">
                            <span class="inline-flex items-center gap-2 bg-gray-100 text-gray-800 px-2 py-1 rounded-md border border-gray-200 text-xs font-semibold">
                                <i class="fa-solid fa-id-card text-[11px] text-gray-500"></i>
                                <span class="text-gray-500 font-medium">Placa:</span>
                                ABC-1234
                            </span>
                            <span class="inline-flex items-center gap-2 bg-gray-100 text-gray-800 px-2 py-1 rounded-md border border-gray-200 text-xs font-semibold">
                                <i class="fa-solid fa-truck-fast text-[11px] text-gray-500"></i>
                                <span class="text-gray-500 font-medium">Marca/Modelo:</span>
                                Volvo FH 540
                            </span>
                        </div>
                    </div>
                </div>
                <img src="pneu-forte-logo.jpeg" alt="Logo" class="vipal-logo">
            </header>

            <main class="flex-grow">
                
                <!-- Detailed Tire List -->
                <div class="mb-8">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 border-b pb-1 inline-block border-gray-800">Histórico de Aferimento de Pneus</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-xs border-collapse border border-gray-300 shadow-sm">
                            <thead class="bg-gray-200">
                                <tr>
                                    <th class="border border-gray-300 p-2 text-center">Pos</th>
                                    <th class="border border-gray-300 p-2 text-left">Marca/Modelo</th>
                                    <th class="border border-gray-300 p-2 text-center bg-gray-100">
                                        27/10/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center">
                                        27/11/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center bg-gray-100">
                                        27/12/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center font-bold">
                                        27/01/26<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center">Status</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white">
                                <!-- Axle 1 -->
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1E</td>
                                    <td class="border border-gray-300 p-2">Michelin</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">104 / 12.0</td>
                                    <td class="border border-gray-300 p-2 text-center">107 / 11.9</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">105 / 11.7</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">108 / 11.6</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1D</td>
                                    <td class="border border-gray-300 p-2">Michelin</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">106 / 12.1</td>
                                    <td class="border border-gray-300 p-2 text-center">105 / 12.0</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">109 / 11.8</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">107 / 11.7</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <!-- Axle 2 -->
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2EE</td>
                                    <td class="border border-gray-300 p-2">Bridgestone</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">101 / 7.2</td>
                                    <td class="border border-gray-300 p-2 text-center">104 / 7.0</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">103 / 6.8</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">102 / 6.6</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2EI</td>
                                    <td class="border border-gray-300 p-2">Bridgestone</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">103 / 7.1</td>
                                    <td class="border border-gray-300 p-2 text-center">101 / 6.9</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">104 / 6.7</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold text-gray-400">-</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-red-600 font-bold text-[10px]">Sem Acesso</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2DI</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">107 / 5.6</td>
                                    <td class="border border-gray-300 p-2 text-center">105 / 5.3</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">106 / 5.0</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold text-gray-400">-</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-red-600 font-bold text-[10px]">Sem Acesso</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2DD</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">109 / 5.4</td>
                                    <td class="border border-gray-300 p-2 text-center">107 / 5.2</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">104 / 5.0</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">106 / 4.8</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                                <!-- Axle 3 -->
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">3EE</td>
                                    <td class="border border-gray-300 p-2">Pirelli</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">108 / 16.9</td>
                                    <td class="border border-gray-300 p-2 text-center">110 / 16.6</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">112 / 16.2</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">111 / 16.0</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">3EI</td>
                                    <td class="border border-gray-300 p-2">Pirelli</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">109 / 17.4</td>
                                    <td class="border border-gray-300 p-2 text-center">112 / 17.1</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">110 / 16.8</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">113 / 16.6</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">3DI</td>
                                    <td class="border border-gray-300 p-2">Continental</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">106 / 10.5</td>
                                    <td class="border border-gray-300 p-2 text-center">104 / 10.2</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">107 / 10.0</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">108 / 9.8</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">3DD</td>
                                    <td class="border border-gray-300 p-2">Continental</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">105 / 10.8</td>
                                    <td class="border border-gray-300 p-2 text-center">109 / 10.6</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">107 / 10.3</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">110 / 10.1</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Pressure Charts Stacked -->
                <div class="mb-8 space-y-8">
                    <h3 class="text-lg font-bold text-gray-800 border-b pb-1 inline-block border-gray-800">Evolução da Pressão por Pneu</h3>
                    
                    <!-- Chart 3: Line -->
                    <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                        <div id="chart-line-pressure-78191" class="w-full h-80"></div>
                    </div>
                </div>
            </main>

            <div class="mt-auto text-right text-xs text-gray-500 pt-4">2/7</div>
        </div>

        <div class="report-page shadow-lg">
            <header class="flex justify-between items-center mb-6 border-b pb-4">
                <div class="flex items-center gap-4">
                    <div class="bg-gray-100 p-3 rounded-lg border border-gray-200">
                        <i class="fa-solid fa-truck text-2xl text-gray-600"></i>
                    </div>
                    <div>
                        <div class="flex items-center gap-2 flex-wrap">
                            <h1 class="text-xl font-bold text-gray-800">Veículo: 79210</h1>
                            <div class="flex items-center gap-2 text-sm text-gray-600 mt-1 flex-wrap">
                                <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded font-medium text-xs">Truck 8x2</span>
                            </div>
                        </div>
                        <div class="flex items-center gap-2 mt-2 flex-wrap">
                            <span class="inline-flex items-center gap-2 bg-gray-100 text-gray-800 px-2 py-1 rounded-md border border-gray-200 text-xs font-semibold">
                                <i class="fa-solid fa-id-card text-[11px] text-gray-500"></i>
                                <span class="text-gray-500 font-medium">Placa:</span>
                                DEF-5678
                            </span>
                            <span class="inline-flex items-center gap-2 bg-gray-100 text-gray-800 px-2 py-1 rounded-md border border-gray-200 text-xs font-semibold">
                                <i class="fa-solid fa-truck-fast text-[11px] text-gray-500"></i>
                                <span class="text-gray-500 font-medium">Marca/Modelo:</span>
                                Scania R 450
                            </span>
                        </div>
                    </div>
                </div>
                <img src="pneu-forte-logo.jpeg" alt="Logo" class="vipal-logo">
            </header>

            <main class="flex-grow">
                <div class="mb-8">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 border-b pb-1 inline-block border-gray-800">Histórico de Aferimento de Pneus</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-xs border-collapse border border-gray-300 shadow-sm">
                            <thead class="bg-gray-200">
                                <tr>
                                    <th class="border border-gray-300 p-2 text-center">Pos</th>
                                    <th class="border border-gray-300 p-2 text-left">Marca/Modelo</th>
                                    <th class="border border-gray-300 p-2 text-center bg-gray-100">
                                        27/10/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center">
                                        27/11/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center bg-gray-100">
                                        27/12/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center font-bold">
                                        27/01/26<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center">Status</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white">
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1E</td>
                                    <td class="border border-gray-300 p-2">Michelin</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">111 / 13.0</td>
                                    <td class="border border-gray-300 p-2 text-center">113 / 12.8</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">112 / 12.6</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">114 / 12.4</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1D</td>
                                    <td class="border border-gray-300 p-2">Michelin</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">109 / 12.9</td>
                                    <td class="border border-gray-300 p-2 text-center">112 / 12.7</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">110 / 12.5</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">113 / 12.3</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2E</td>
                                    <td class="border border-gray-300 p-2">Bridgestone</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">104 / 11.2</td>
                                    <td class="border border-gray-300 p-2 text-center">106 / 11.0</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">105 / 10.8</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">107 / 10.6</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2D</td>
                                    <td class="border border-gray-300 p-2">Bridgestone</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">103 / 11.1</td>
                                    <td class="border border-gray-300 p-2 text-center">105 / 10.9</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">104 / 10.7</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">106 / 10.5</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">3EE</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">118 / 8.2</td>
                                    <td class="border border-gray-300 p-2 text-center">116 / 8.0</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">117 / 7.7</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">119 / 7.5</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">3EI</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">117 / 8.1</td>
                                    <td class="border border-gray-300 p-2 text-center">115 / 7.9</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">116 / 7.6</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">118 / 7.4</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">3DI</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">116 / 8.0</td>
                                    <td class="border border-gray-300 p-2 text-center">117 / 7.8</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">115 / 7.5</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">117 / 7.2</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">3DD</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">119 / 8.3</td>
                                    <td class="border border-gray-300 p-2 text-center">118 / 8.1</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">119 / 7.8</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">120 / 7.6</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">4EE</td>
                                    <td class="border border-gray-300 p-2">Pirelli</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">113 / 6.9</td>
                                    <td class="border border-gray-300 p-2 text-center">112 / 6.6</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">114 / 6.3</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">115 / 6.0</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">4EI</td>
                                    <td class="border border-gray-300 p-2">Pirelli</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">114 / 6.8</td>
                                    <td class="border border-gray-300 p-2 text-center">113 / 6.5</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">115 / 6.2</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">116 / 5.9</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">4DI</td>
                                    <td class="border border-gray-300 p-2">Pirelli</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">112 / 6.7</td>
                                    <td class="border border-gray-300 p-2 text-center">114 / 6.4</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">113 / 6.1</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">115 / 5.8</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">4DD</td>
                                    <td class="border border-gray-300 p-2">Pirelli</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">115 / 7.0</td>
                                    <td class="border border-gray-300 p-2 text-center">116 / 6.7</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">114 / 6.4</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">117 / 6.1</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="mb-8 space-y-8">
                    <h3 class="text-lg font-bold text-gray-800 border-b pb-1 inline-block border-gray-800">Evolução da Pressão por Pneu</h3>
                    <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                        <div id="chart-line-pressure-79210" class="w-full h-80"></div>
                    </div>
                </div>
            </main>

            <div class="mt-auto text-right text-xs text-gray-500 pt-4">3/7</div>
        </div>

        <div class="report-page shadow-lg">
            <header class="flex justify-between items-center mb-6 border-b pb-4">
                <div class="flex items-center gap-4">
                    <div class="bg-gray-100 p-3 rounded-lg border border-gray-200">
                        <i class="fa-solid fa-bus text-2xl text-gray-600"></i>
                    </div>
                    <div>
                        <div class="flex items-center gap-2 flex-wrap">
                            <h1 class="text-xl font-bold text-gray-800">Veículo: 80345</h1>
                            <div class="flex items-center gap-2 text-sm text-gray-600 mt-1 flex-wrap">
                                <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded font-medium text-xs">Ônibus 4x2</span>
                            </div>
                        </div>
                        <div class="flex items-center gap-2 mt-2 flex-wrap">
                            <span class="inline-flex items-center gap-2 bg-gray-100 text-gray-800 px-2 py-1 rounded-md border border-gray-200 text-xs font-semibold">
                                <i class="fa-solid fa-id-card text-[11px] text-gray-500"></i>
                                <span class="text-gray-500 font-medium">Placa:</span>
                                GHI-9012
                            </span>
                            <span class="inline-flex items-center gap-2 bg-gray-100 text-gray-800 px-2 py-1 rounded-md border border-gray-200 text-xs font-semibold">
                                <i class="fa-solid fa-truck-fast text-[11px] text-gray-500"></i>
                                <span class="text-gray-500 font-medium">Marca/Modelo:</span>
                                Mercedes-Benz O 500 RSD
                            </span>
                        </div>
                    </div>
                </div>
                <img src="pneu-forte-logo.jpeg" alt="Logo" class="vipal-logo">
            </header>

            <main class="flex-grow">
                <div class="mb-8">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 border-b pb-1 inline-block border-gray-800">Histórico de Aferimento de Pneus</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-xs border-collapse border border-gray-300 shadow-sm">
                            <thead class="bg-gray-200">
                                <tr>
                                    <th class="border border-gray-300 p-2 text-center">Pos</th>
                                    <th class="border border-gray-300 p-2 text-left">Marca/Modelo</th>
                                    <th class="border border-gray-300 p-2 text-center bg-gray-100">
                                        27/10/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center">
                                        27/11/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center bg-gray-100">
                                        27/12/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center font-bold">
                                        27/01/26<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center">Status</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white">
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1E</td>
                                    <td class="border border-gray-300 p-2">Michelin</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">100 / 14.5</td>
                                    <td class="border border-gray-300 p-2 text-center">102 / 14.2</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">101 / 14.0</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">103 / 13.8</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1D</td>
                                    <td class="border border-gray-300 p-2">Michelin</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">99 / 14.4</td>
                                    <td class="border border-gray-300 p-2 text-center">101 / 14.1</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">100 / 13.9</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">102 / 13.7</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2EE</td>
                                    <td class="border border-gray-300 p-2">Continental</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">108 / 8.9</td>
                                    <td class="border border-gray-300 p-2 text-center">110 / 8.6</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">109 / 8.3</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">111 / 8.0</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2EI</td>
                                    <td class="border border-gray-300 p-2">Continental</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">107 / 8.8</td>
                                    <td class="border border-gray-300 p-2 text-center">109 / 8.5</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">108 / 8.2</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">110 / 7.9</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2DI</td>
                                    <td class="border border-gray-300 p-2">Continental</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">109 / 9.0</td>
                                    <td class="border border-gray-300 p-2 text-center">111 / 8.7</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">110 / 8.4</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">112 / 8.1</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2DD</td>
                                    <td class="border border-gray-300 p-2">Continental</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">110 / 8.7</td>
                                    <td class="border border-gray-300 p-2 text-center">109 / 8.4</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">111 / 8.1</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">113 / 7.8</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="mb-8 space-y-8">
                    <h3 class="text-lg font-bold text-gray-800 border-b pb-1 inline-block border-gray-800">Evolução da Pressão por Pneu</h3>
                    <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                        <div id="chart-line-pressure-80345" class="w-full h-80"></div>
                    </div>
                </div>
            </main>

            <div class="mt-auto text-right text-xs text-gray-500 pt-4">4/7</div>
        </div>

        <div class="report-page shadow-lg">
            <header class="flex justify-between items-center mb-6 border-b pb-4">
                <div class="flex items-center gap-4">
                    <div class="bg-gray-100 p-3 rounded-lg border border-gray-200">
                        <i class="fa-solid fa-truck text-2xl text-gray-600"></i>
                    </div>
                    <div>
                        <div class="flex items-center gap-2 flex-wrap">
                            <h1 class="text-xl font-bold text-gray-800">Veículo: 81602</h1>
                            <div class="flex items-center gap-2 text-sm text-gray-600 mt-1 flex-wrap">
                                <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded font-medium text-xs">4x4</span>
                            </div>
                        </div>
                        <div class="flex items-center gap-2 mt-2 flex-wrap">
                            <span class="inline-flex items-center gap-2 bg-gray-100 text-gray-800 px-2 py-1 rounded-md border border-gray-200 text-xs font-semibold">
                                <i class="fa-solid fa-id-card text-[11px] text-gray-500"></i>
                                <span class="text-gray-500 font-medium">Placa:</span>
                                JKL-3456
                            </span>
                            <span class="inline-flex items-center gap-2 bg-gray-100 text-gray-800 px-2 py-1 rounded-md border border-gray-200 text-xs font-semibold">
                                <i class="fa-solid fa-truck-fast text-[11px] text-gray-500"></i>
                                <span class="text-gray-500 font-medium">Marca/Modelo:</span>
                                Volvo FM 460
                            </span>
                        </div>
                    </div>
                </div>
                <img src="pneu-forte-logo.jpeg" alt="Logo" class="vipal-logo">
            </header>

            <main class="flex-grow">
                <div class="mb-8">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 border-b pb-1 inline-block border-gray-800">Histórico de Aferimento de Pneus</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-xs border-collapse border border-gray-300 shadow-sm">
                            <thead class="bg-gray-200">
                                <tr>
                                    <th class="border border-gray-300 p-2 text-center">Pos</th>
                                    <th class="border border-gray-300 p-2 text-left">Marca/Modelo</th>
                                    <th class="border border-gray-300 p-2 text-center bg-gray-100">
                                        27/10/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center">
                                        27/11/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center bg-gray-100">
                                        27/12/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center font-bold">
                                        27/01/26<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center">Status</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white">
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1E</td>
                                    <td class="border border-gray-300 p-2">Michelin</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">96 / 10.2</td>
                                    <td class="border border-gray-300 p-2 text-center">98 / 10.1</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">97 / 9.9</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">99 / 9.8</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1D</td>
                                    <td class="border border-gray-300 p-2">Michelin</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">97 / 10.4</td>
                                    <td class="border border-gray-300 p-2 text-center">96 / 10.2</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">98 / 10.0</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">100 / 9.9</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2E</td>
                                    <td class="border border-gray-300 p-2">Continental</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">92 / 8.6</td>
                                    <td class="border border-gray-300 p-2 text-center">94 / 8.4</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">93 / 8.2</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">95 / 8.0</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2D</td>
                                    <td class="border border-gray-300 p-2">Continental</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">93 / 8.7</td>
                                    <td class="border border-gray-300 p-2 text-center">95 / 8.5</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">94 / 8.3</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">96 / 8.1</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="mb-8 space-y-8">
                    <h3 class="text-lg font-bold text-gray-800 border-b pb-1 inline-block border-gray-800">Evolução da Pressão por Pneu</h3>
                    <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                        <div id="chart-line-pressure-81602" class="w-full h-80"></div>
                    </div>
                </div>
            </main>

            <div class="mt-auto text-right text-xs text-gray-500 pt-4">5/7</div>
        </div>

        <div class="report-page shadow-lg">
            <header class="flex justify-between items-center mb-6 border-b pb-4">
                <div class="flex items-center gap-4">
                    <div class="bg-gray-100 p-3 rounded-lg border border-gray-200">
                        <i class="fa-solid fa-truck text-2xl text-gray-600"></i>
                    </div>
                    <div>
                        <div class="flex items-center gap-2 flex-wrap">
                            <h1 class="text-xl font-bold text-gray-800">Veículo: 82977</h1>
                            <div class="flex items-center gap-2 text-sm text-gray-600 mt-1 flex-wrap">
                                <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded font-medium text-xs">Carreta 3 eixos</span>
                            </div>
                        </div>
                        <div class="flex items-center gap-2 mt-2 flex-wrap">
                            <span class="inline-flex items-center gap-2 bg-gray-100 text-gray-800 px-2 py-1 rounded-md border border-gray-200 text-xs font-semibold">
                                <i class="fa-solid fa-id-card text-[11px] text-gray-500"></i>
                                <span class="text-gray-500 font-medium">Placa:</span>
                                MNO-7890
                            </span>
                            <span class="inline-flex items-center gap-2 bg-gray-100 text-gray-800 px-2 py-1 rounded-md border border-gray-200 text-xs font-semibold">
                                <i class="fa-solid fa-truck-fast text-[11px] text-gray-500"></i>
                                <span class="text-gray-500 font-medium">Marca/Modelo:</span>
                                Iveco Hi-Way 600S44
                            </span>
                        </div>
                    </div>
                </div>
                <img src="pneu-forte-logo.jpeg" alt="Logo" class="vipal-logo">
            </header>

            <main class="flex-grow">
                <div class="mb-8">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 border-b pb-1 inline-block border-gray-800">Histórico de Aferimento de Pneus</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-xs border-collapse border border-gray-300 shadow-sm">
                            <thead class="bg-gray-200">
                                <tr>
                                    <th class="border border-gray-300 p-2 text-center">Pos</th>
                                    <th class="border border-gray-300 p-2 text-left">Marca/Modelo</th>
                                    <th class="border border-gray-300 p-2 text-center bg-gray-100">
                                        27/10/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center">
                                        27/11/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center bg-gray-100">
                                        27/12/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center font-bold">
                                        27/01/26<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center">Status</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white">
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1EE</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">116 / 9.4</td>
                                    <td class="border border-gray-300 p-2 text-center">118 / 9.2</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">117 / 9.0</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">119 / 8.8</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1EI</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">115 / 9.5</td>
                                    <td class="border border-gray-300 p-2 text-center">117 / 9.3</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">116 / 9.1</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">118 / 8.9</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1DI</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">117 / 9.6</td>
                                    <td class="border border-gray-300 p-2 text-center">116 / 9.4</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">118 / 9.2</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">119 / 9.0</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1DD</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">118 / 9.3</td>
                                    <td class="border border-gray-300 p-2 text-center">117 / 9.1</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">119 / 8.9</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">120 / 8.7</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2EE</td>
                                    <td class="border border-gray-300 p-2">Bridgestone</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">112 / 8.2</td>
                                    <td class="border border-gray-300 p-2 text-center">114 / 8.0</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">113 / 7.8</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">115 / 7.6</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2EI</td>
                                    <td class="border border-gray-300 p-2">Bridgestone</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">111 / 8.3</td>
                                    <td class="border border-gray-300 p-2 text-center">113 / 8.1</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">112 / 7.9</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">114 / 7.7</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2DI</td>
                                    <td class="border border-gray-300 p-2">Bridgestone</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">113 / 8.1</td>
                                    <td class="border border-gray-300 p-2 text-center">115 / 7.9</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">114 / 7.7</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">116 / 7.5</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2DD</td>
                                    <td class="border border-gray-300 p-2">Bridgestone</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">114 / 8.0</td>
                                    <td class="border border-gray-300 p-2 text-center">113 / 7.8</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">115 / 7.6</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">116 / 7.4</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">3EE</td>
                                    <td class="border border-gray-300 p-2">Pirelli</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">110 / 6.2</td>
                                    <td class="border border-gray-300 p-2 text-center">112 / 6.0</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">111 / 5.8</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">113 / 5.6</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">3EI</td>
                                    <td class="border border-gray-300 p-2">Pirelli</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">109 / 6.3</td>
                                    <td class="border border-gray-300 p-2 text-center">111 / 6.1</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">110 / 5.9</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">112 / 5.7</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">3DI</td>
                                    <td class="border border-gray-300 p-2">Pirelli</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">111 / 6.1</td>
                                    <td class="border border-gray-300 p-2 text-center">113 / 5.9</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">112 / 5.7</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">114 / 5.5</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">3DD</td>
                                    <td class="border border-gray-300 p-2">Pirelli</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">112 / 6.0</td>
                                    <td class="border border-gray-300 p-2 text-center">111 / 5.8</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">113 / 5.6</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">115 / 5.4</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="mb-8 space-y-8">
                    <h3 class="text-lg font-bold text-gray-800 border-b pb-1 inline-block border-gray-800">Evolução da Pressão por Pneu</h3>
                    <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                        <div id="chart-line-pressure-82977" class="w-full h-80"></div>
                    </div>
                </div>
            </main>

            <div class="mt-auto text-right text-xs text-gray-500 pt-4">6/7</div>
        </div>

        <div class="report-page shadow-lg">
            <header class="flex justify-between items-center mb-6 border-b pb-4">
                <div class="flex items-center gap-4">
                    <div class="bg-gray-100 p-3 rounded-lg border border-gray-200">
                        <i class="fa-solid fa-truck text-2xl text-gray-600"></i>
                    </div>
                    <div>
                        <div class="flex items-center gap-2 flex-wrap">
                            <h1 class="text-xl font-bold text-gray-800">Veículo: 84510</h1>
                            <div class="flex items-center gap-2 text-sm text-gray-600 mt-1 flex-wrap">
                                <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded font-medium text-xs">Truck 4x2</span>
                            </div>
                        </div>
                        <div class="flex items-center gap-2 mt-2 flex-wrap">
                            <span class="inline-flex items-center gap-2 bg-gray-100 text-gray-800 px-2 py-1 rounded-md border border-gray-200 text-xs font-semibold">
                                <i class="fa-solid fa-id-card text-[11px] text-gray-500"></i>
                                <span class="text-gray-500 font-medium">Placa:</span>
                                PQR-2468
                            </span>
                            <span class="inline-flex items-center gap-2 bg-gray-100 text-gray-800 px-2 py-1 rounded-md border border-gray-200 text-xs font-semibold">
                                <i class="fa-solid fa-truck-fast text-[11px] text-gray-500"></i>
                                <span class="text-gray-500 font-medium">Marca/Modelo:</span>
                                DAF XF 530
                            </span>
                        </div>
                    </div>
                </div>
                <img src="pneu-forte-logo.jpeg" alt="Logo" class="vipal-logo">
            </header>

            <main class="flex-grow">
                <div class="mb-8">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 border-b pb-1 inline-block border-gray-800">Histórico de Aferimento de Pneus</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-xs border-collapse border border-gray-300 shadow-sm">
                            <thead class="bg-gray-200">
                                <tr>
                                    <th class="border border-gray-300 p-2 text-center">Pos</th>
                                    <th class="border border-gray-300 p-2 text-left">Marca/Modelo</th>
                                    <th class="border border-gray-300 p-2 text-center bg-gray-100">
                                        27/10/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center">
                                        27/11/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center bg-gray-100">
                                        27/12/25<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center font-bold">
                                        27/01/26<br><span class="text-[10px] font-normal">PSI / mm</span>
                                    </th>
                                    <th class="border border-gray-300 p-2 text-center">Status</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white">
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1E</td>
                                    <td class="border border-gray-300 p-2">Michelin</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">102 / 12.6</td>
                                    <td class="border border-gray-300 p-2 text-center">104 / 12.4</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">103 / 12.2</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">105 / 12.0</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">1D</td>
                                    <td class="border border-gray-300 p-2">Michelin</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">101 / 12.5</td>
                                    <td class="border border-gray-300 p-2 text-center">103 / 12.3</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">102 / 12.1</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">104 / 11.9</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-green-600 font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2EE</td>
                                    <td class="border border-gray-300 p-2">Bridgestone</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">118 / 7.4</td>
                                    <td class="border border-gray-300 p-2 text-center">117 / 7.1</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">119 / 6.8</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">120 / 6.6</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2EI</td>
                                    <td class="border border-gray-300 p-2">Bridgestone</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">116 / 7.6</td>
                                    <td class="border border-gray-300 p-2 text-center">118 / 7.3</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">117 / 7.0</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">119 / 6.7</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2DI</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">115 / 7.2</td>
                                    <td class="border border-gray-300 p-2 text-center">114 / 6.9</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">116 / 6.6</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">117 / 6.4</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 text-center font-bold">2DD</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">117 / 7.1</td>
                                    <td class="border border-gray-300 p-2 text-center">116 / 6.8</td>
                                    <td class="border border-gray-300 p-2 text-center bg-gray-50">118 / 6.5</td>
                                    <td class="border border-gray-300 p-2 text-center font-bold">119 / 6.3</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="text-yellow-600 font-bold">Atenção</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="mb-8 space-y-8">
                    <h3 class="text-lg font-bold text-gray-800 border-b pb-1 inline-block border-gray-800">Evolução da Pressão por Pneu</h3>
                    <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                        <div id="chart-line-pressure-84510" class="w-full h-80"></div>
                    </div>
                </div>

                <div class="mt-8 mb-8">
                    <p class="text-gray-800">Atenciosamente,</p>
                    <p class="font-bold text-gray-800 mt-4">Welington Pires do Nascimento</p>
                    <p class="font-bold text-gray-600">Consultor de Frotas</p>
                </div>
            </main>

            <div class="mt-auto text-right text-xs text-gray-500 pt-4">7/7</div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const sizeRegex = /^text-(xs|sm|base|lg|xl|\d+xl|\[.*\])$/;

            const isInlineMmRow = (el) => {
                if (!(el instanceof HTMLElement)) return false;
                if (!el.classList.contains('flex') || !el.classList.contains('items-center')) return false;
                if (!el.classList.contains('w-max')) return false;

                const icon = el.querySelector(':scope > i.fa-flag');
                const span = el.querySelector(':scope > span');
                if (!icon || !span) return false;

                const txt = (span.textContent || '').trim();
                return txt.endsWith('mm');
            };

            const calloutSelectors = [
                'div[class*="absolute right-full mr-2 top-1/2 transform -translate-y-1/2"]',
                'div[class*="absolute left-full ml-2 top-1/2 transform -translate-y-1/2"]'
            ];

            calloutSelectors.forEach((selector) => {
                const callouts = Array.from(document.querySelectorAll(selector));

                callouts.forEach((callout) => {
                    const parent = callout.parentElement;
                    if (!parent) return;

                    callout.remove();

                    // Interleave: PSI box -> mm callout -> PSI box -> mm callout
                    // (keeps both values visible and avoids overlay)
                    callout.className = 'pf-mm-badge inline-flex items-center justify-center gap-1 w-max bg-white border border-gray-300 rounded px-1 py-0 shadow-sm text-[10px] leading-none -mt-1 -mb-1';

                    const span = callout.querySelector('span');
                    if (span) {
                        const classes = span.className.split(/\s+/).filter(Boolean);
                        span.className = classes.filter(c => !sizeRegex.test(c)).concat(['text-[10px]']).join(' ');
                    }

                    const icon = callout.querySelector('i');
                    if (icon) {
                        const classes = icon.className.split(/\s+/).filter(Boolean);
                        icon.className = classes.filter(c => !sizeRegex.test(c)).concat(['text-[10px]']).join(' ');
                    }

                    parent.insertAdjacentElement('afterend', callout);
                });
            });

            // Clean up: previous version could mistakenly style axle containers.
            const mistakenlyStyled = Array.from(document.querySelectorAll('div[class*="flex-col"][class*="bg-white"][class*="border-gray-300"][class*="shadow-sm"]'));
            mistakenlyStyled.forEach((el) => {
                el.classList.remove('bg-white', 'border', 'border-gray-300', 'rounded', 'px-1', 'py-0', 'shadow-sm');
            });

            // Front axle (and any other) mm rows that were already inline (not absolute callouts)
            // also get the same fixed background badge for readability.
            const mmRows = Array.from(document.querySelectorAll('div.flex.items-center.w-max'))
                .filter((row) => isInlineMmRow(row) && !row.classList.contains('pf-mm-badge'));

            mmRows.forEach((row) => {
                row.classList.add('pf-mm-badge', 'bg-white', 'border', 'border-gray-300', 'rounded', 'px-1', 'py-0', 'shadow-sm');

                const span = row.querySelector(':scope > span');
                if (span) {
                    const classes = span.className.split(/\s+/).filter(Boolean);
                    span.className = classes.filter(c => !sizeRegex.test(c)).concat(['text-[10px]']).join(' ');
                }

                const icon = row.querySelector(':scope > i');
                if (icon) {
                    const classes = icon.className.split(/\s+/).filter(Boolean);
                    icon.className = classes.filter(c => !sizeRegex.test(c)).concat(['text-[10px]']).join(' ');
                }
            });

            // Chart Initialization
            const config = { responsive: true, displayModeBar: false };

            const baseLayout = {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { family: 'Inter, sans-serif' },
                margin: { t: 30, r: 20, b: 60, l: 40 },
                showlegend: true,
                legend: { orientation: 'h', y: -0.2 },
                xaxis: { title: '' },
                yaxis: { title: 'PSI' }
            };

            function parsePsi(cellText) {
                const raw = String(cellText || '').trim();
                if (!raw || raw === '-') return null;
                const match = raw.match(/(\d+(?:[.,]\d+)?)\s*\/\s*\d+(?:[.,]\d+)?/);
                if (!match) return null;
                const num = Number(match[1].replace(',', '.'));
                return Number.isFinite(num) ? num : null;
            }

            function colorForPosition(pos, hasNull) {
                const p = String(pos || '').trim();
                if (hasNull) return '#dc2626';
                if (p.startsWith('1')) return '#16a34a';
                if (p.startsWith('2')) return '#ca8a04';
                return '#2563eb';
            }

            function getPageMonths(tableEl) {
                const headerCells = Array.from(tableEl.querySelectorAll('thead th'));
                const dateCells = headerCells.slice(2, -1);
                return dateCells.map((th) => {
                    const text = (th.textContent || '').trim();
                    return text.split(/\s+/)[0] || text;
                });
            }

            function extractTiresDataFromTable(tableEl) {
                const rows = Array.from(tableEl.querySelectorAll('tbody tr'));
                return rows
                    .map((tr) => {
                        const cells = Array.from(tr.querySelectorAll('td'));
                        if (cells.length < 4) return null;

                        const pos = (cells[0].textContent || '').trim();
                        const psiCells = cells.slice(2, -1);
                        const data = psiCells.map((td) => parsePsi(td.textContent));
                        const hasNull = data.some((v) => v == null);

                        return {
                            name: pos,
                            data,
                            color: colorForPosition(pos, hasNull)
                        };
                    })
                    .filter(Boolean);
            }

            function computePsiRange(tiresData) {
                const values = tiresData.flatMap((t) => t.data).filter((v) => typeof v === 'number' && Number.isFinite(v));
                if (!values.length) return null;
                const min = Math.min(...values);
                const max = Math.max(...values);
                const pad = Math.max(3, Math.round((max - min) * 0.15));
                return [Math.floor(min - pad), Math.ceil(max + pad)];
            }

            function initLineChartsFromTables() {
                const charts = Array.from(document.querySelectorAll('[id^="chart-line-pressure-"]'));
                charts.forEach((chartEl) => {
                    const page = chartEl.closest('.report-page');
                    const tableEl = page?.querySelector('table');
                    if (!tableEl) return;

                    const months = getPageMonths(tableEl);
                    const tiresData = extractTiresDataFromTable(tableEl);
                    if (!months.length || !tiresData.length) return;

                    const lineTraces = tiresData.map((tire) => ({
                        x: months,
                        y: tire.data,
                        name: tire.name,
                        type: 'scatter',
                        mode: 'lines+markers',
                        line: { width: 3, color: tire.color },
                        marker: { size: 6 }
                    }));

                    const range = computePsiRange(tiresData);
                    const lineLayout = {
                        ...baseLayout,
                        margin: { t: 20, r: 20, b: 40, l: 40 },
                        yaxis: range ? { ...baseLayout.yaxis, range } : baseLayout.yaxis
                    };

                    Plotly.newPlot(chartEl.id, lineTraces, lineLayout, config);
                });
            }

            if (window.Plotly?.newPlot) {
                initLineChartsFromTables();
            }
        });
    </script>
</body>

</html>
