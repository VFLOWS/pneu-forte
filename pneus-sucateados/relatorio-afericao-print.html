<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório de Inspeção de Frota</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="pneu-forte-colors.css">
    <script src="tailwind.config.js"></script>
    <style>
        @media print {
            .no-print {
                display: none !important;
            }

            .page-break {
                page-break-before: always;
            }

            body {
                background: white;
                -webkit-print-color-adjust: exact;
            }

            #report-container {
                box-shadow: none;
                margin: 0;
                width: 100%;
            }

            .report-page {
                margin: 0;
                page-break-after: always;
                height: auto;
                min-height: 297mm;
            }
        }

        .report-page {
            width: 210mm;
            min-height: 297mm;
            background: white;
            padding: 20mm;
            margin: 0 auto;
            position: relative;
            display: flex;
            flex-direction: column;
            margin-bottom: 2rem;
        }

        .tire-box {
            width: 80px;
            padding: 4px;
            text-align: center;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            background-color: #f9fafb;
        }

        .tire-value {
            font-weight: bold;
            font-size: 0.9rem;
        }

        .tire-psi {
            font-size: 0.75rem;
            color: #6b7280;
        }

        .axle-line {
            height: 4px;
            background-color: #d1d5db;
            width: 100%;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            z-index: 0;
        }

        /* Extra breathing room for the smallest PSI boxes */
        .report-page div[class*="text-[10px]"][class*="border-2"][class*="border-black"] {
            padding-top: 0.35rem !important;
            padding-bottom: 0.35rem !important;
            padding-left: 0.35rem !important;
            padding-right: 0.35rem !important;
            line-height: 1.1;
        }

        /* Standard padding for all PSI boxes (helps red ones too) */
        .report-page div[class*="border-2"][class*="border-black"][class*="rounded"][class*="shadow-sm"][class*="text-center"] {
            padding-left: 0.35rem;
            padding-right: 0.35rem;
        }

        /* mm callouts are repositioned via JS to avoid overlap */
    </style>
</head>

<body class="bg-gray-200 font-sans">

    <!-- Controls -->
    <div class="fixed top-4 left-4 z-50 no-print">
        <a href="frota-analise-detalhe.html"
            class="px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 flex items-center shadow-md transition-colors">
            <i class="fa-solid fa-arrow-left mr-2"></i>
            Voltar
        </a>
    </div>

    <div class="fixed top-4 right-4 z-50 no-print">
        <button onclick="window.print()"
            class="px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center font-medium shadow-md transition-colors">
            <i class="fa-solid fa-print mr-2"></i>
            Imprimir / Salvar PDF
        </button>
    </div>

    <div id="report-container" class="mx-auto my-8">

        <!-- Page 1: Cover / Intro -->
        <div class="report-page shadow-lg flex flex-col">
            <header class="flex justify-between items-start mb-16">
                <div>
                    <h2 class="text-lg font-bold">Cliente teste</h2>
                    <p class="text-sm">Sr. X</p>
                </div>
                <div class="text-right">
                    <img src="pneu-forte-logo.jpeg" alt="Pneu Forte Logo" class="vipal-logo ml-auto">
                    <p class="text-sm mt-2">27/01/2026</p>
                </div>
            </header>

            <main class="flex-grow flex flex-col justify-center items-center">
                <h1 class="text-2xl font-bold mb-12">RELATÓRIO DE AFERIÇÃO</h1>
                <div class="text-sm text-gray-700 max-w-3xl space-y-4 text-justify">
                    <p><strong>Caro Cliente,</strong></p>
                    <p>O Programa de Orientação ao Transportador (Protrans) é um conjunto de serviços exclusivos da
                        Vipal para aprimorar o desempenho da sua frota. Por meio de visitas, palestras, treinamentos e
                        implantação de softwares de gerenciamento, nossos consultores ajudam você e sua equipe a rodar
                        com muito mais economia e segurança.</p>
                    <p>O relatório que você verá a seguir apresenta os dados avaliados na <strong>AFERIÇÃO DE
                            PNEUS</strong>, seguidos de orientação técnica recomendada por nossa equipe. Tudo isto para
                        você obter ótimos resultados de seus pneus.</p>
                    <p>Para que este trabalho tenha sucesso, é fundamental o envolvimento e comprometimento da sua
                        empresa em todas as suas etapas. Nossa equipe de consultores de negócios e o seu Reformador
                        Autorizado Vipal encontram-se a disposição para a plena realização deste projeto e elaboração de
                        Plano de Ação das melhorias.</p>
                </div>
            </main>

            <footer class="pt-16 mt-auto">
                <div class="flex items-end justify-between">
                    <div class="w-64">
                        <p class="border-t border-black pt-2 font-bold text-gray-800">Welington Pires do Nascimento</p>
                        <p class="text-xs text-gray-600">Consultor de Frotas</p>
                        <p class="text-xs font-bold mt-1 text-gray-800">Vipal Borrachas</p>
                    </div>
                    <div class="text-right text-xs text-gray-500 mb-4">1/8</div>
                </div>
            </footer>
        </div>

        <!-- Page 2: Vehicle 78191 -->
        <div class="report-page shadow-lg flex flex-col">
            <header class="flex justify-between items-center mb-6 border-b pb-4">
           <h1 class="text-xl font-bold text-gray-800">Veículo: 78191 - Tipo: Truck 6x2</h1>
            </header>

            <div class="flex-grow flex flex-col">
                <!-- Image Placeholder -->
                <div class="mb-8 flex justify-end">
                    <div
                        class="w-44 h-28 bg-gray-200 border border-gray-300 flex items-center justify-center text-gray-400 text-xs rounded shadow-inner">
                        <div class="text-center">
                            <i class="fa-regular fa-image text-2xl mb-1 block"></i>
                            <span>Foto do Veículo</span>
                        </div>
                    </div>
                </div>

                <!-- Vehicle Diagram -->
                <div class="relative h-80 my-auto flex items-center justify-center">
                    <!-- Chassis -->
                    <div class="absolute w-full h-12 bg-black z-0 rounded shadow-md"></div>
                    <div class="absolute w-full h-12 flex items-center justify-center text-white font-bold z-20 rounded text-lg pointer-events-none">
                        --- Veículo: 78191 ---
                    </div>

                    <!-- Axles Container -->
                    <div class="relative z-10 w-full h-full flex justify-evenly items-center px-4">
                        <!-- Axle 1 -->
                        <div class="flex flex-col h-full relative group w-32 items-center">
                            <div class="absolute top-0 bottom-0 w-3 bg-black z-0 left-1/2 transform -translate-x-1/2">
                            </div>

                            <!-- Top -->
                            <div class="z-10 mt-2 mb-auto flex flex-col gap-2 w-full items-center">
                                <div class="flex items-center gap-2 mb-1 w-max">
                                    <i class="fa-solid fa-flag text-gray-400 text-xs"></i>
                                    <span class="text-green-600 font-bold text-sm">11,0mm</span>
                                </div>
                                <div
                                    class="w-28 bg-blue-600 text-white font-bold text-center py-1.5 border-2 border-black rounded shadow-sm text-lg relative z-10">
                                    113 PSI</div>
                            </div>

                            <!-- Bottom -->
                            <div class="z-10 mt-auto mb-2 flex flex-col-reverse gap-2 w-full items-center">
                                <div class="flex items-center gap-2 mt-1 w-max">
                                    <i class="fa-solid fa-flag text-gray-400 text-xs"></i>
                                    <span class="text-green-600 font-bold text-sm">11,0mm</span>
                                </div>
                                <div
                                    class="w-28 bg-blue-600 text-white font-bold text-center py-1.5 border-2 border-black rounded shadow-sm text-lg relative z-10">
                                    113 PSI</div>
                            </div>
                        </div>

                        <!-- Axle 2 -->
                        <div class="flex flex-col h-full relative group w-32 items-center">
                            <div class="absolute top-0 bottom-0 w-3 bg-black z-0 left-1/2 transform -translate-x-1/2">
                            </div>

                            <!-- Top Group -->
                            <div class="z-10 mt-2 mb-auto flex flex-col gap-2 w-full items-center">
                                <!-- Outer -->
                                <div
                                    class="w-28 bg-green-600 text-white font-bold text-center py-1.5 border-2 border-black rounded shadow-sm relative text-lg z-10">
                                    108 PSI
                                    <div
                                        class="absolute right-full mr-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1 w-max">
                                        <span class="text-green-600 font-bold text-sm">5,8mm</span>
                                        <i class="fa-solid fa-flag text-gray-400 text-xs"></i>
                                    </div>
                                </div>
                                <!-- Inner -->
                                <div
                                    class="w-28 bg-yellow-500 text-white font-bold text-center py-1.5 border-2 border-black rounded shadow-sm relative text-lg z-10">
                                    X
                                    <div
                                        class="absolute right-full mr-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1 w-max">
                                        <span class="text-red-600 font-bold text-sm">X</span>
                                        <i class="fa-solid fa-flag text-gray-400 text-xs"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Bottom Group -->
                            <div class="z-10 mt-auto mb-2 flex flex-col gap-2 w-full items-center">
                                <!-- Inner -->
                                <div
                                    class="w-28 bg-yellow-500 text-white font-bold text-center py-1.5 border-2 border-black rounded shadow-sm relative text-lg z-10">
                                    X
                                    <div
                                        class="absolute right-full mr-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1 w-max">
                                        <span class="text-red-600 font-bold text-sm">X</span>
                                        <i class="fa-solid fa-flag text-gray-400 text-xs"></i>
                                    </div>
                                </div>
                                <!-- Outer -->
                                <div
                                    class="w-28 bg-green-600 text-white font-bold text-center py-1.5 border-2 border-black rounded shadow-sm relative text-lg z-10">
                                    106 PSI
                                    <div
                                        class="absolute right-full mr-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1 w-max">
                                        <span class="text-red-600 font-bold text-sm">4,2mm</span>
                                        <i class="fa-solid fa-flag text-gray-400 text-xs"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Axle 3 -->
                        <div class="flex flex-col h-full relative group w-32 items-center">
                            <div class="absolute top-0 bottom-0 w-3 bg-black z-0 left-1/2 transform -translate-x-1/2">
                            </div>

                            <!-- Top Group -->
                            <div class="z-10 mt-2 mb-auto flex flex-col gap-2 w-full items-center">
                                <!-- Outer -->
                                <div
                                    class="w-28 bg-blue-600 text-white font-bold text-center py-1.5 border-2 border-black rounded shadow-sm relative text-lg z-10">
                                    114 PSI
                                    <div
                                        class="absolute right-full mr-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1 w-max">
                                        <span class="text-green-600 font-bold text-sm">17,0mm</span>
                                        <i class="fa-solid fa-flag text-gray-400 text-xs"></i>
                                    </div>
                                </div>
                                <!-- Inner -->
                                <div
                                    class="w-28 bg-blue-600 text-white font-bold text-center py-1.5 border-2 border-black rounded shadow-sm relative text-lg z-10">
                                    114 PSI
                                    <div
                                        class="absolute right-full mr-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1 w-max">
                                        <span class="text-green-600 font-bold text-sm">17,5mm</span>
                                        <i class="fa-solid fa-flag text-gray-400 text-xs"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Bottom Group -->
                            <div class="z-10 mt-auto mb-2 flex flex-col gap-2 w-full items-center">
                                <!-- Inner -->
                                <div
                                    class="w-28 bg-blue-600 text-white font-bold text-center py-1.5 border-2 border-black rounded shadow-sm relative text-lg z-10">
                                    114 PSI
                                    <div
                                        class="absolute right-full mr-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1 w-max">
                                        <span class="text-green-600 font-bold text-sm">9,2mm</span>
                                        <i class="fa-solid fa-flag text-gray-400 text-xs"></i>
                                    </div>
                                </div>
                                <!-- Outer -->
                                <div
                                    class="w-28 bg-blue-600 text-white font-bold text-center py-1.5 border-2 border-black rounded shadow-sm relative text-lg z-10">
                                    113 PSI
                                    <div
                                        class="absolute right-full mr-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1 w-max">
                                        <span class="text-green-600 font-bold text-sm">9,7mm</span>
                                        <i class="fa-solid fa-flag text-gray-400 text-xs"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recommendations & Tables -->
                <div class="mt-auto">
                    <h3 class="font-bold text-black mb-2 text-lg">Recomendação:</h3>
                    <div class="border-b-2 border-black mb-2 pb-1">
                        <p class="text-sm">Realizar a correção da calibragem, dos pneus indicados com divergência.</p>
                    </div>
                    <div class="border-b-2 border-black mb-3 pb-1">
                        <p class="text-sm">Pneus 2EI e 2DI, estão com tampa na valvula e sem alongador, o que impede de
                            realizar a conferencia.</p>
                    </div>
                    <div class="border-b-2 border-black mb-3 pb-1">
                        <p class="text-sm">Pneu 38010, esta com um objeto perfurante na banda de rodagem.</p>
                    </div>

                </div>
            </div>

            <footer class="mt-4 text-right text-xs text-gray-500">2/8</footer>
        </div>



        <!-- Page Summary -->
        <div class="report-page shadow-lg">
            <header class="flex justify-between items-center mb-8">
                <h1 class="text-xl font-bold text-gray-800">Veículo: 78191 - Tipo: Truck 6x2</h1>
                <img src="pneu-forte-logo.jpeg" alt="Logo" class="vipal-logo">
            </header>

            <main class="flex-grow">
                <div class="grid grid-cols-2 gap-8 mb-8">
                    <!-- Chart: Life Cycle -->
                    <div class="bg-white p-4 rounded-lg border border-gray-200">
                        <h3 class="text-lg font-bold text-gray-800 mb-4">Estimativa de Vida Útil (Sulco)</h3>
                        <div id="chart-life-summary" class="w-full h-64"></div>
                    </div>
                    <!-- Chart: Pressure -->
                    <div class="bg-white p-4 rounded-lg border border-gray-200">
                        <h3 class="text-lg font-bold text-gray-800 mb-4">Distribuição de Pressão</h3>
                        <div id="chart-pressure-summary" class="w-full h-64"></div>
                    </div>
                </div>

                <!-- Detailed Tire List -->
                <div class="mb-8">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 border-b pb-1 inline-block border-gray-800">Relação de Pneus</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-xs border-collapse border border-gray-300 shadow-sm">
                            <thead class="bg-gray-200">
                                <tr>
                                    <th class="border border-gray-300 p-2 text-left">Placa</th>
                                    <th class="border border-gray-300 p-2 text-center">Posição</th>
                                    <th class="border border-gray-300 p-2 text-left">Marca/Modelo</th>
                                    <th class="border border-gray-300 p-2 text-right">Pressão (PSI)</th>
                                    <th class="border border-gray-300 p-2 text-right">Sulco (mm)</th>
                                    <th class="border border-gray-300 p-2 text-center">Status</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white">
                                <!-- Axle 1 -->
                                <tr>
                                    <td class="border border-gray-300 p-2">ABC-1234</td>
                                    <td class="border border-gray-300 p-2 text-center">1E</td>
                                    <td class="border border-gray-300 p-2">Michelin</td>
                                    <td class="border border-gray-300 p-2 text-right">113</td>
                                    <td class="border border-gray-300 p-2 text-right">11.0</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="px-2 py-0.5 bg-green-100 text-green-700 rounded-full font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2">ABC-1234</td>
                                    <td class="border border-gray-300 p-2 text-center">1D</td>
                                    <td class="border border-gray-300 p-2">Michelin</td>
                                    <td class="border border-gray-300 p-2 text-right">113</td>
                                    <td class="border border-gray-300 p-2 text-right">11.0</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="px-2 py-0.5 bg-green-100 text-green-700 rounded-full font-bold">Ok</span></td>
                                </tr>
                                <!-- Axle 2 -->
                                <tr>
                                    <td class="border border-gray-300 p-2">ABC-1234</td>
                                    <td class="border border-gray-300 p-2 text-center">2EE</td>
                                    <td class="border border-gray-300 p-2">Bridgestone</td>
                                    <td class="border border-gray-300 p-2 text-right">108</td>
                                    <td class="border border-gray-300 p-2 text-right">5.8</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="px-2 py-0.5 bg-yellow-100 text-yellow-800 rounded-full font-bold">Atenção</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2">ABC-1234</td>
                                    <td class="border border-gray-300 p-2 text-center">2EI</td>
                                    <td class="border border-gray-300 p-2">Bridgestone</td>
                                    <td class="border border-gray-300 p-2 text-right">-</td>
                                    <td class="border border-gray-300 p-2 text-right">-</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="px-2 py-0.5 bg-red-100 text-red-700 rounded-full font-bold">Sem Acesso</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2">ABC-1234</td>
                                    <td class="border border-gray-300 p-2 text-center">2DI</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-right">-</td>
                                    <td class="border border-gray-300 p-2 text-right">-</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="px-2 py-0.5 bg-red-100 text-red-700 rounded-full font-bold">Sem Acesso</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2">ABC-1234</td>
                                    <td class="border border-gray-300 p-2 text-center">2DD</td>
                                    <td class="border border-gray-300 p-2">Goodyear</td>
                                    <td class="border border-gray-300 p-2 text-right">106</td>
                                    <td class="border border-gray-300 p-2 text-right">4.2</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="px-2 py-0.5 bg-yellow-100 text-yellow-800 rounded-full font-bold">Atenção</span></td>
                                </tr>
                                <!-- Axle 3 -->
                                <tr>
                                    <td class="border border-gray-300 p-2">ABC-1234</td>
                                    <td class="border border-gray-300 p-2 text-center">3EE</td>
                                    <td class="border border-gray-300 p-2">Pirelli</td>
                                    <td class="border border-gray-300 p-2 text-right">114</td>
                                    <td class="border border-gray-300 p-2 text-right">17.0</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="px-2 py-0.5 bg-green-100 text-green-700 rounded-full font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2">ABC-1234</td>
                                    <td class="border border-gray-300 p-2 text-center">3EI</td>
                                    <td class="border border-gray-300 p-2">Pirelli</td>
                                    <td class="border border-gray-300 p-2 text-right">114</td>
                                    <td class="border border-gray-300 p-2 text-right">17.5</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="px-2 py-0.5 bg-green-100 text-green-700 rounded-full font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2">ABC-1234</td>
                                    <td class="border border-gray-300 p-2 text-center">3DI</td>
                                    <td class="border border-gray-300 p-2">Continental</td>
                                    <td class="border border-gray-300 p-2 text-right">114</td>
                                    <td class="border border-gray-300 p-2 text-right">9.2</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="px-2 py-0.5 bg-green-100 text-green-700 rounded-full font-bold">Ok</span></td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2">ABC-1234</td>
                                    <td class="border border-gray-300 p-2 text-center">3DD</td>
                                    <td class="border border-gray-300 p-2">Continental</td>
                                    <td class="border border-gray-300 p-2 text-right">113</td>
                                    <td class="border border-gray-300 p-2 text-right">9.7</td>
                                    <td class="border border-gray-300 p-2 text-center"><span class="px-2 py-0.5 bg-green-100 text-green-700 rounded-full font-bold">Ok</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="mt-8 mb-8">
                    <p class="text-gray-800">Atenciosamente,</p>
                    <p class="font-bold text-gray-800 mt-4">Welington Pires do Nascimento</p>
                    <p class="font-bold text-gray-600">Consultor de Frotas</p>
                </div>
            </main>

            <div class="mt-auto text-right text-xs text-gray-500 pt-4">8/8</div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const sizeRegex = /^text-(xs|sm|base|lg|xl|\d+xl|\[.*\])$/;

            const isInlineMmRow = (el) => {
                if (!(el instanceof HTMLElement)) return false;
                if (!el.classList.contains('flex') || !el.classList.contains('items-center')) return false;
                if (!el.classList.contains('w-max')) return false;

                const icon = el.querySelector(':scope > i.fa-flag');
                const span = el.querySelector(':scope > span');
                if (!icon || !span) return false;

                const txt = (span.textContent || '').trim();
                return txt.endsWith('mm');
            };

            const calloutSelectors = [
                'div[class*="absolute right-full mr-2 top-1/2 transform -translate-y-1/2"]',
                'div[class*="absolute left-full ml-2 top-1/2 transform -translate-y-1/2"]'
            ];

            calloutSelectors.forEach((selector) => {
                const callouts = Array.from(document.querySelectorAll(selector));

                callouts.forEach((callout) => {
                    const parent = callout.parentElement;
                    if (!parent) return;

                    callout.remove();

                    // Interleave: PSI box -> mm callout -> PSI box -> mm callout
                    // (keeps both values visible and avoids overlay)
                    callout.className = 'pf-mm-badge inline-flex items-center justify-center gap-1 w-max bg-white border border-gray-300 rounded px-1 py-0 shadow-sm text-[10px] leading-none -mt-1 -mb-1';

                    const span = callout.querySelector('span');
                    if (span) {
                        const classes = span.className.split(/\s+/).filter(Boolean);
                        span.className = classes.filter(c => !sizeRegex.test(c)).concat(['text-[10px]']).join(' ');
                    }

                    const icon = callout.querySelector('i');
                    if (icon) {
                        const classes = icon.className.split(/\s+/).filter(Boolean);
                        icon.className = classes.filter(c => !sizeRegex.test(c)).concat(['text-[10px]']).join(' ');
                    }

                    parent.insertAdjacentElement('afterend', callout);
                });
            });

            // Clean up: previous version could mistakenly style axle containers.
            const mistakenlyStyled = Array.from(document.querySelectorAll('div[class*="flex-col"][class*="bg-white"][class*="border-gray-300"][class*="shadow-sm"]'));
            mistakenlyStyled.forEach((el) => {
                el.classList.remove('bg-white', 'border', 'border-gray-300', 'rounded', 'px-1', 'py-0', 'shadow-sm');
            });

            // Front axle (and any other) mm rows that were already inline (not absolute callouts)
            // also get the same fixed background badge for readability.
            const mmRows = Array.from(document.querySelectorAll('div.flex.items-center.w-max'))
                .filter((row) => isInlineMmRow(row) && !row.classList.contains('pf-mm-badge'));

            mmRows.forEach((row) => {
                row.classList.add('pf-mm-badge', 'bg-white', 'border', 'border-gray-300', 'rounded', 'px-1', 'py-0', 'shadow-sm');

                const span = row.querySelector(':scope > span');
                if (span) {
                    const classes = span.className.split(/\s+/).filter(Boolean);
                    span.className = classes.filter(c => !sizeRegex.test(c)).concat(['text-[10px]']).join(' ');
                }

                const icon = row.querySelector(':scope > i');
                if (icon) {
                    const classes = icon.className.split(/\s+/).filter(Boolean);
                    icon.className = classes.filter(c => !sizeRegex.test(c)).concat(['text-[10px]']).join(' ');
                }
            });

            // Chart Initialization
            const chartLayout = {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { family: 'Inter, sans-serif' },
                margin: { t: 20, r: 20, b: 30, l: 40 },
                showlegend: true,
                legend: { orientation: 'h', y: -0.2 }
            };
            const config = { responsive: true, displayModeBar: false };

            // Life Cycle Chart
            const lifeData = [{
                x: ['Em condição', 'Atenção', 'Crítico'],
                y: [6, 2, 2],
                type: 'bar',
                marker: { color: ['#16a34a', '#eab308', '#dc2626'] },
                text: [6, 2, 2],
                textposition: 'auto'
            }];
            if (document.getElementById('chart-life-summary')) {
                Plotly.newPlot('chart-life-summary', lifeData, { ...chartLayout, yaxis: { title: 'Qtde Pneus' }, showlegend: false }, config);
            }

            // Pressure Chart
            const pressureData = [{
                values: [6, 2, 2],
                labels: ['Correta', 'Baixa', 'Sem Acesso'],
                type: 'pie',
                marker: { colors: ['#16a34a', '#dc2626', '#9ca3af'] },
                textinfo: 'label+percent',
                hole: 0.4
            }];
            if (document.getElementById('chart-pressure-summary')) {
                Plotly.newPlot('chart-pressure-summary', pressureData, { ...chartLayout, margin: {t:0, b:0, l:0, r:0} }, config);
            }
        });
    </script>
</body>

</html>
